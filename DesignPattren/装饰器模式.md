Decorator关注为对象动态的添加功能, Proxy关注对象的信息隐藏及访问控制.
Decorator体现多态性, Proxy体现封装性

对于添加缓存这个应用场景使用哪种模式，要看设计者的意图，如果设计者不需要用户关
注是否使用缓存功能，要隐藏实现细节，也就是说用户只能看到和使用代理类，那么就使
用proxy模式；反之，如果设计者需要用户自己决定是否使用缓存的功能，需要用户自己新
建原始对象并动态添加缓存功能，那么就使用decorator模式。

装饰器模式主要解决继承关系过于复杂的问题，通过组合来替代继承。它主要的作用是给原
始类添加增强功能。这也是判断是否该用装饰器模式的一个重要的依据。除此之外，装饰器
模式还有一个特点，那就是可以对原始类嵌套使用多个装饰器。为了满足这个应用场景，在
设计的时候，装饰器类需要跟原始类继承相同的抽象类或者接口。



### 代理模式与装饰器模式区别？

https://www.zhihu.com/question/41988550



代理模式，侧重于不能直接访问一个对象，只能通过代理来间接访问，比如对象在另外一台机器上，或者对象被持久化了，对象是受保护的。对象在另外一台机器上，其实就是rpc，感兴趣的可以看看dubbo的源码本地反问的其实就是远程对象的代理，只不过代理帮你做了访问这个对象之前和之后的很多事情，但是对使用者是透明的了。对象被持久化了，比如mybatis的mapperProxy。通过mapper文件自动生成代理类。第三种，对内核对象的访问。

装饰器模式是因为没法在编译器就确定一个对象的功能，需要运行时动态的给对象添加职责，所以只能把对象的功能拆成一一个个的小部分，动态组装，感兴趣的可以看看dubbo的源码，里面的mock，cluster，failover都是通过装饰器来实现的。因为这些功能是由使用者动态配置的。但是代理模式在编译器其实就已经确定了和代理对象的关系。

这两个设计模式是为了解决不同的问题而抽象总结出来的。是可以混用的。可以在代理的基础上在加一个装饰，也可以在装饰器的基础上在加一个代理。感兴趣的去看看dubbo源码，里面就是这么实现的。



作者：海岸红杉
链接：https://www.zhihu.com/question/41988550/answer/567925484
来源：知乎
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。